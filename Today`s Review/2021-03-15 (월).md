

###### 1. 학습 날짜

- 2021 - 03 - 15(월)

---

###### 2. 학습시간

- 10:00 ~ 18:00

---

###### 3. 학습 범위 및 주제

- js동작, 브라우저 동작순서

---

###### 4. 동료 학습 방법 

- daelee, taelee, jehong, mihykim

---

###### 5. 학습 목표 

- 브라우저엔진과 js엔진의 구성에 대해 정리

---

###### 6. 상세 학습 내용

- 코드작성시간 :  시간

 JS엔진은 메모리힙과 콜스택(싱글스레드)

브라우저에서 제공하는 웹 API



브라우저는 다음과 같이 구성되어있다

- 사용자 인터페이스 : 새로고침, 홈, 북마크 등.
- 브라우저 엔진 : 사용자인터페이스, 렌더링엔진 사이 동작 제어
- 렌더링 엔진 : 사용자가 요청한 내용을 서버로부터 받아 브라우저 화면에 표시하는 역할 -> HTML, CSS파싱 DOM 트리, 랜더트리, 그리기
- 통신: HTTP, FTP요청과 같은 네트워크 호출에 사용
- ui 백엔드 : 콤보박스, 창 등을 그림
- js 인터프리터 : JS코드의 결과를 랜더링엔진에게 실행. 각 브라우저는 크롬의 V8과 같이 스크립팅 엔진을 사용한다. (js엔진 == js인터프리터)
- 자료저장소 : 쿠키 등을 하드디스크에 저장하는 계층





브라우저가 HTML을 파싱하고 외부자원들을 로드할 때 JS를 만나면 파싱을 중단한다 (CSS는 X => DOM트리를 변경하지 않아서.)

body태그 끝에 두는 이유. 중간에 스크립트를 두면 사용자 경험을 망침. 또 DOM을 만들기 전에 요소를 조작하는 JS가 작성되어있다면 제대로 동작하지 않을 것. body가 해석되기전 JS삽입을 원하면 `DOMContentLoaded` 이벤트 작성



JS엔진의 구성은 다음과 같다.

메모리 힙

콜스택

그리고 JS는 싱글스레드언어 (콜스택이 하나이기 떄문)다. 한번의 하나의 요청만 수행한다면 문제가 생길 수 있다. 예를들어, 수십초씩 걸리는 작업이 있을 때 사용자가 그 시간동안 아무런 작업도 할 수 없다면 누가 그 웹브라우저를 사용할까

그래서 사용되는 개념이 이벤트루프다.

브라우저에서는 동시성을 지원하는 이벤트루프를 갖고 있다.

전체적인 예제로 이해해보자.

비동기함수의 처리순서는 다음과 같다.

JS의 콜스택에 setTimeout비동기함수가 올라간다. 이는 webAPI에서 처리된다.(콜스택 pop) 여기서 콜백과 setTimeout작업을 수행한다.

setTimeout에 지정된 시간이 지난 후  Task Queue에 콜백함수를 전달한다.

이벤트루프는 콜스택이 비었는지 계속확인하고 있는 상태이며, 콜스택이 비면 Task Queue의 콜백을 콜스택으로 전달해 비동기함수내의 콜백을 콜스택에서 실행하게 된다.

비동기에 대한 처리를 이벤트루프가 계속 반복해서 확인해주어 콜스택에 쌓아 진행하기 때문에 싱글쓰레드처럼 동작하지만 동시성을 지원받을 수 있다.

---

###### 7. 학습 내용에 대한 개인적인 총평

- 브라우저에 대해서 정리한 것은 처음인데, 생각보다 많은 부분을 담당하고 규모도 크다고 느낌.

###### 8. 다음 학습 계획

- Js