---
###### 1. 학습 날짜

- 2020 - 07 - 15(수)
 

---

###### 2. 학습시간

- 10:00 ~ 18:00

---

###### 3. 학습 범위 및 주제

- 도커 명령어 정리

---

###### 4. 동료 학습 방법 

- daelee, taelee, jehong, mihykim

---

###### 5. 학습 목표 

- 도커를 이용하기 위한 명령어 정리

---

###### 6. 상세 학습 내용

- 코드작성시간 : 5 시간

도커는 컨테이너라는 독립된 환경을 만들고 이를 구획화하여 애플리케이션의 실행환경을 만든다.
이 구획을 나누는 것이 `namespace	`라는 기능을 사용한다. `namespace`가 다르면 동일 이름이라도 다른 실체로 처리하고, 충돌을 줄일 수 있다.
컨테이너를 구획하기 위한 라벨링같은 개념으로 이해하면 될 것 같다.

[추가적인 설명자료](https://tech.ssut.me/what-even-is-a-container/)

<br>

## Nginx 웹서버 작동시키기
Nginx는 대량의 요청을 처리하는 대규모 사이트에서 주로 사용하고, [리버스 프록시](https://www.lesstif.com/system-admin/forward-proxy-reverse-proxy-21430345.html), [로드밸런서](https://nesoy.github.io/articles/2018-06/Load-Balancer)같은 기능도 갖고 있다.
~~리버스프록시가 현재 프로젝트에서 사용하고 있는 프록시와 같은 기능이지 않나?~~


### Docker이미지 다운로드
Docker Hub에서 Nginx 공식 이미지를 제공한다.
`docker pull nginx` 명령어로 이미지를 다운로드 받는다.
`docker image ls` 현재 존재하는 이미지를 확인한다.

### Docker 이미지 작동
`docker container run --name webserver -d -p 80:80 nginx`
`nginx 이미지`를 사용하여 `webserver`라는 이름의 컨테이너를 기동시킨다. `80번`포트에 대한 엑세스를 위하여 `-p`옵션을 붙여 컨테이너가 보내는 전송을 허가한다.

`localhost:80`으로 브라우저에서 접속하면 nginx가 정상적으로 작동하고 있다는 것을 알 수 있고, 
`docker container ps`로 nginx 서버의 상태를 확인할 수 있다. 내용으로는 Container ID, Image, Status, PORTS 등이 있다.

컨테이너 정지명령어는 `docker stop webserver`으로 사용할 수 있고
기동했던 컨테이너를 다시 시작하려면 `docker start webserver`으로 할 수 있다.

이미지 삭제는 `docker image rm 옵션 image_name`으로 할 수 있으며, `--force`옵션을 두어 강제로 삭제할 수 있다.

<br>
<br>
<br>

### 컨테이너 라이프 사이클

컨테이너에는 라이프 사이클이 존재한다.
도커 이미지로부터 컨테이너를 생성하거나 생성과 시작을 동시에 할 수 있고, 정지 그리고 삭제하는 상태를 가질 수 있다,

#### 컨테이너 생성 및 시작 (docker container run)
`docker container run [실행옵션] 이미지명[:태그명]`명령어를 사용하면 생성과 시작을 동시에 할 수 있다.

컨테이너는 대화식, 백그라운드식으로 동작시킬 수 있다.
먼저 대화식으로 컨테이너를 실행해보자. 이는 콘솔에서 대화식으로 명령을 실행할 수 있는 방식이다.
예를 들자면, `docker container run -it --name "컨테이너명" 이미지명 /bin/cal`이라는 명령어를 사용한다고 하자. 다음과 같은 해석을 할 수 있다.

- centos이미지를 바탕으로 "컨테이너명"을 가진 컨테이너를 실행하고, 컨테이너 안에서 `/bin/cal`명령어를 수행한다.
- `--name`으로 컨테이너 명을 지정한다.
- `-it`는 콘솔에 결과를 출력하는 옵션이다.

<br>

백그라운드방식은 실행옵션을 `-d`로 지정하여 사용한다.
예를 들어보자!
`docker container run -d centos /bin/ping localhost`
- 컨테이너를 생성, 시작한다.
- 백그라운드에서 centos이미지를 실행하고ㅓ, 컨테이너에서 `/bin/ping../`을 실행한다.

#### 컨테이너 시작
`docker container start` 정지중인 컨테이너를 시작할 때 사용
#### 컨테이너 정지
`docker container stop` 실행 중인 컨테이너를 정지
#### 컨테이너 삭제
`docker container rm` 컨테이너 삭제, 일시 정지에는 `docker container pause`명령을 사용

<br>
<br>
<br>



### 컨테이너 네트워크 설정

`docker container run [네트워크 옵션] 이미지명[:태그명]` 을 이용해 컨테이너의 네트워크를 설정할 수 있다.
컨테이너의 포트번호를 매핑할 때 다음과 같은 명령어를 사용한다.

`docker container run -d -p 8080:80 nginx`
이 명령어에 대한 해석은, nginx라는 이름의 이미지를 바탕으로 컨테이너를 생성하고 백그라운드에서 시작한다.
이 때 호스트의 8080포트와 컨테이너의 80포트를 매핑시킨다.

이렇게 하면, 호스트에서 8080포트로 액세스하면 컨테이너에서 작동하는 80포트의 서비스로 액세스 할 수 있는 것이다.

현재 로컬에서 컨테이너를 해당 옵션으로 수행할 때 `localhost:8080`로 접속한다고 하면 실제로 컨테이너의  `localhost:80`으로 액세스 하는 것이라고 이해하면 될 것 같다.



이 외에도 DNS서버지정, MAC주소 지정, 자원지정 등등 엄청나게 많다..!

<br>
<br>
다음 장에는 dockerfile에 대한 설명과 작성방법 등에 대해서 정리해보고자한다.

---

###### 7. 학습 내용에 대한 개인적인 총평

- nginx를 구동시키면서 명령어 정리를 진행했다.
- 생각보다 도커를 유연하게 사용하기 위해 필요한 선수 지식들이 많았다.
- 웹 프로젝트를 같이 진행하고 있는데 많은 도움이 될 것 같다.

###### 8. 다음 학습 계획

- nodejs 무중단서비스를 위한 학습