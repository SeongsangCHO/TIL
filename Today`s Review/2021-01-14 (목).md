

###### 1. 학습 날짜

- 2021 - 01 - 14(목)

---

###### 2. 학습시간

- 10:00 ~ 18:00

---

###### 3. 학습 범위 및 주제

- 쿠버네티스

---

###### 4. 동료 학습 방법 

- daelee, taelee, jehong, mihykim

---

###### 5. 학습 목표 

- 쿠버네티스 mysql

---

###### 6. 상세 학습 내용

- 코드작성시간 :  시간

- # 서비스

  - 클러스터IP 타입 ⇒ 로드밸런서가 아니라 외부에 노출이 되지 않음(외부아이피가 없음)
  - 이 파드는 wordpress, phpmyadmin과 연결되어야함.
  - ClusterIP는 클러스터 내부에 새로운 IP를 할당하고 여러 개의 Pod을 바라보는 로드밸런서 기능을 제공

  # 디플로이먼트

  - replicas : 1
  - 재생성 전략
  - mysqldb-container 이름의 파드
  - 3306포트 사용
  - 볼륨 마운트 /var/lib/mysql ⇒ PVC ⇒ PV간 연결

  # PV, PVC

  mysqldb-pv ↔ mysqldb-pvc로 서로 연결

  # 에러

  id, password 지정 create_db.sql

  ```jsx
  CREATE DATABASE wp_db;
  GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'root' WITH GRANT OPTION;
  FLUSH PRIVILEGES;
  ```

  ## wordpress 연결에러

  ```jsx
  Warning: mysqli_real_connect(): php_network_getaddresses: getaddrinfo failed: Name does not resolve in /www/wordpress/wp-includes/wp-db.php on line 1653
  
  Warning: mysqli_real_connect(): (HY000/2002): php_network_getaddresses: getaddrinfo failed: Name does not resolve in /www/wordpress/wp-includes/wp-db.php on line 1653
  php_network_getaddresses: getaddrinfo failed: Name does not resolve
  ```

  ⇒ 흠,wp-config.php 32번, 34, 36라인 ip와 호스트 네임 확인

  ## phpmyadmin 연결에러

  ```
  mysqli_real_connect(): php_network_getaddresses: getaddrinfo failed: Name does not resolve
  mysqli_real_connect(): (HY000/2002): php_network_getaddresses: getaddrinfo failed: Name does not resolve
  ```

  ⇒ mysql연결이 되지 않았다. ⇒ 각 종 변수들 확인

  ## 해결 config.inc.php에 호스트네임 오타났었음

  phpmyadmin의 config.inc.php 확인

  ```jsx
  $cfg['Servers'][$i]['host'] = 'mysql-service'; => 서비스이름과 같은지
  $cfg['Servers'][$i]['port'] = '3306';
  $cfg['Servers'][$i]['user'] = 'root';
  $cfg['Servers'][$i]['password'] = 'root'; => mysql 비밀번호 확인
  ```

---

###### 7. 학습 내용에 대한 개인적인 총평

- 쿠버네티스 mysql 구현, 도커파일 확인 잘하기..!

###### 8. 다음 학습 계획

- 쿠버네티스