

###### 1. 학습 날짜

- 2020 - 08 - 05(수)

---

###### 2. 학습시간

- 10:00 ~ 18:00

---

###### 3. 학습 범위 및 주제

- 예발자, 더미데이터에 맞게 파싱

---

###### 4. 동료 학습 방법 

- daelee, taelee, jehong, mihykim

---

###### 5. 학습 목표 

- 요청받은 구조에 맞게 DB에서 데이터를 출력해 JSON형태로 구조를 가공해서 API생성

---

###### 6. 상세 학습 내용

- 코드작성시간 :  4시간

- front팀에서 원하는 데이터 구조에 맞게 DB에서 쿼리문을 통해 데이터를 출력하고 구조에 맞게 파싱한다.

- ```javascript
  
  router.get('/reviews', function(req, res, next){
  
    let sql;
  
    sql ="select replace(programs.link, '/', '') as program,  reviews.link,  reviews.title,  reviews.content,  reviews.post_date  from reviews  inner join programs on reviews.programs_id = programs.id";
    db.query(sql, (error, result) => {
      if (error) throw error;
      let obj = {};
      //데이터를 담을 객체 obj 생성
      result.map(v => { 
        //쿼리문 결과가 객체 배열, 이를 반복함.
       if (!(v.program in obj))
          obj[v.program] = [];        
          //객체에서 program이라는 키가 obj에 존재하지 않으면, 해당 키값에 대한 배열 생성
        obj[v.program].push(v);
        //program의 키값을 갖는 객체에 v객체 할당.
        delete v['program'];
        //program의 키는 사용하지 않으므로 삭제함.
      })
      console.log(obj);
       res.json(obj);
    })
  })
  ```

  `sql`문으로 reviews 테이블에 있는 데이터들을 출력한다.

  programs테이블의 link컬럼 데이터도 필요하므로 `inner join`으로 같이 출력한다.

  `replace`로 `/`문자를 공백으로 대체한다.

  데이터가 JSON형태로 제공될 것이므로 이를 담을 수 있는 `obj` 빈 객체를 새로 생성한다.

  쿼리문의 결과인 `result`를 반복한다.

  `obj[v.program]`에 빈 배열을 할당한다.

  빈 배열에 `v`객체들을 `push`한다.

  `program` 키는 필요 없으므로 `delete`한다.

---

###### 7. 학습 내용에 대한 개인적인 총평

- 단순구조의 json파싱이라 작업이 금방 끝났다.
- 다음에 해야할 `FAQ`데이터 파싱은 depth가 존재해서 여라 객체와 배열들을 그 안에 다시 넣어야하는 작업이 필요한데, 고민해봐야할 사항이다.

###### 8. 다음 학습 계획

- FAQ파싱하기