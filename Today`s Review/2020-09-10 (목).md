

###### 1. 학습 날짜

- 2020 - 09 - 10(목)

---

###### 2. 학습시간

- 10:00 ~ 18:00

---

###### 3. 학습 범위 및 주제

- JS

---

###### 4. 동료 학습 방법 

- daelee, taelee, jehong, mihykim

---

###### 5. 학습 목표 

- 렉시컬환경, 클로저

---

###### 6. 상세 학습 내용

- 코드작성시간 :  시간

## 자바스크립트 #11 렉시컬환경, 클로저



JS에선 실행 중인 함수 + 코드블록, 스크립트 전체는 렉시컬 환경이라 불리는 internal hidden associated object를 갖는다.

렉시컬환경 = 내부숨김 연관 객체

렉시컬환경 객체는 다음으로 구성됨.

- 환경레코드 : 모든 지역변수를 프로퍼티로 가진 객체.
- 외부 렉시컬 환경: 외부 코드와 연관됨.





### 전역 렉시컬환경의 변화 ( 변수 )



`let pharse = "hello";` 이 있을 때 렉시컬환경은 하나만 존재한다.

`pharse: "Hello" => null`

화살표는 외부참조를 나타내고, 그 전의 값은 변수가 저장되는 환경레코드를 나타낸다.



코드가 실행될 수록 렉시컬환경은 변화한다.

![image](https://user-images.githubusercontent.com/55486644/91686222-af307900-eb97-11ea-9396-bfcdabd28bf8.png)



변수는 환경레코드의 프로퍼티.

변수를 변경하면 환경레코드의 프로퍼티가 변화한다.





### 함수선언문

함수는 변수와 달리 바로 **초기화**됨.

선언문으로 선언한 함수는 렉시컬 환경이 만들어지는 즉시 사용할 수 있다.



`function say(){...}`이렇게 말임.

`let say = function(name){....}`의 함수 표현식은 바로 사용할 수 없음.



함수를 호출하면 새로운 렉시컬환경이 자동으로 만들어짐.

해당 환경에는 함수호출시 매개변수와, 지역변수가 저장됨.

![image](https://user-images.githubusercontent.com/55486644/91686778-29adc880-eb99-11ea-83dd-04220ad9a412.png)

 호출중임 함수를 위한 내부,  외부 렉시컬환경를 갖게된다.





함수가 호출되면 함수내의 내부렉시컬, 그리고 함수가 참조하는 외부렉시컬이 생성되는 것.

함수는 `alert`에서 `phrase와 매개변수인 name`을 참조하고 있음.

먼저, 내부렉시컬에서 `name`을 검색하고 내부렉시컬에 없는 `pharse`는 외부렉시컬에서 검색을 확장함.

이 과정을 전역 렉시컬 환경까지 확장될 때까지 반복한다.



해당 예시를보자

![image-20200831151237869](C:\Users\secho\AppData\Roaming\Typora\typora-user-images\image-20200831151237869.png)

`makeCounter`은 함수를 반환한다.

지역변수인 `count`는 어떻게 값이 저장될 까

모든 함수는 함수가 생성된 곳의 렉시컬 환경을 기억한다

함수는 `[[Environment]]`라는 숨김 프로퍼티를 갖는데 여기에 함수가 만들어진 곳의 렉시컬환경에 대한 `참조`가 저장된다.

`counter`의 environment에는 `count`이 있는 렉시컬 환경에 대한 참조가 저장된다.

그래서 호출할 때 마다, environment에 있는 참조를 이용해 `count`에 접근하여 값이 증가한다.

`counter`을 호출할 때마다 새로운 렉시컬환경을 생성한다.



- [클로저](https://en.wikipedia.org/wiki/Closure_(computer_programming))는 외부 변수를 기억하고 이 외부 변수에 접근할 수 있는 함수를 의미합니다. 

- 함수내에서 함수를 정의하고 사용하면 클로저라고 흔히 표현함.
- Environment프로퍼티와 내부렉시컬에서 외부로 참조를 한다는 것을 기억해두자.



위에서 `counter`호출할 때 새로운 렉시컬환경이 생성된다고 했다.

이 렉시컬환경은 다른 객체와 같이 `도달할 수 없을 때` 메모리에서 삭제된다.

 

`counter = null`을 해야 이에 해당하는 렉시컬환경도 메모리에서 제거된다.





---

###### 7. 학습 내용에 대한 개인적인 총평

- 함수내에서 함수를 정의해 사용하는 것이 클로저.
- 함수형프로그래밍에서 강조되는 핵심개념
- 자주 사용하다보면 익숙해질 것.

###### 8. 다음 학습 계획

- HTTP학습

