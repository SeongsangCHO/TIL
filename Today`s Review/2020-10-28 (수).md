

###### 1. 학습 날짜

- 2020 - 10 - 28(수)

---

###### 2. 학습시간

- 10:00 ~ 18:00

---

###### 3. 학습 범위 및 주제

- 인터뷰

---

###### 4. 동료 학습 방법 

- daelee, taelee, jehong, mihykim

---

###### 5. 학습 목표 

- CORS란?

---

###### 6. 상세 학습 내용

과거에 웹은 단순히 클라이언트의 요청에 따라 특정 서버의 텍스트나 이미지를 제공해주어도 충분했습니다.
하지만 현대에 오면서 웹 서버는 클라이언트에게 한 번에 더 많은 데이터, 서비스를 제공해주기 위해서 자신이 가지고 있는 정보를 넘어 다른 서버의 정보까지 한 번에 보여주려고 했죠. 다시 말해 프론트엔드 서버와 API 서버를 따로 두는것입니다.

클라이언트에게 한 번에 다양한 서버의 정보를 한 번에 보여주는 방법은 2가지가 있습니다.

1. 프론트엔드 서버가 다른 웹 서버들의 정보를 요청하고 응답받아서 한 번에 데이터를 정리하여 클라이언트에게 보내주는 방법
2. 프론트엔드 서버는 클라이언트에게 프론트엔드 기본 폼만 보내고 다른 웹 서버들의 정보는 클라이언트가 직접 요청하여 응답받는 방법
   1번의 방법도 있었지만 서버 부하와 클라이언트 응답속도가 늦었기 때문에 개발자들은 2번의 방법을 활용하려 했습니다.

하지만 웹브라우저 정책 중 도메인이 다르면 요청을 주고 받을 수 없는 정책이 있습니다. SOP(Same-Origin Policy)
그래서 당시의 개발자들은 이 정책을 우회하는 방법으로 JSONP 라는 방법으로 우회하여 다른 도메인의 정보를 가져왔었지만 이는 공식적인 방법도 아니었고, CSRF(Cross-site request forgery), XSS(cross-site scripting)와 같은 보안 문제가 있었습니다.

시대에 변화에 클라이언트(웹브라우저)는 이를 공식적으로 인정하는 정책을 만들었는데 이것이 바로 CORS(Cross Origin Resuorce Sharing) 입니다. (다른 출처간의 리소스 공유)
따라서 CORS 정책을 따른다면 다른 출처(서버)의 리소스를 요청,응답을 받을 수 있게 되었습니다.
CORS 정책은 브라우저의 구현 스팩, 정책 위반 문제이기 때문에 백엔드 개발자가 서버 어플리케이션에서 응답 헤더에 올바른 Acccess-Control-Allow-Origin 이 내려오도록 셋팅 해주면 됩니다. (이는 웹 서버에서 cors 관련 허용을 눌러주면 매우 간단하게 해결? (쿨럭))

------

추가 내용

### 같은 출처, 다른 출처, Origin은 무엇일까요?

출처, Origin란 URL의 구성 요소 중 Scheme, Host, Port가 동일해야 합니다.
예를 들어

1. https://naver.com/about
2. https://naver.com/about?q=kukim멋져
3. http://naver.com/about
4. http://naver.com/:8080
   의 URL이 있을 때 1,2번은 동일한 origin이지만 3번은 Scheme가 다름, 4번은 포트번호가 다르기 때문에 다른 출처가 됩니다. (Internet Explorer는 4번의 경우 동일하게 인식하지만..)

### 웹 클라이언트가 다른 출처의 리소스를 요청

웹 클라이언트(브라우저)가 다른 출처의 리소스를 요청할 떄 HTTP 프로토콜을 사용하여 요청하는데
이때 브라우저는 요청 헤더에
`Orgin` 이라는 필드에 요청을 보내는 출처를 함께 담아 보낸다.
ex) https://www.yebalja.com/jobs 웹사이트에 내용 중 https://www.jobkorea.com/developer/list.js 를 가져온다고 한다면

1. 클라이언트가 https://www.jobkorea.com/developer/list.js에 요청 메세지를 보냄 (OPTION 메세지, 예비 요청,요청 해도 되는지)
   그 헤더에 Origin: https://www.yebalja.com/jobs 를 추가하여 보내는 방식

ex)

```
OPTIONS https://www.jobkorea.com/developer/list.js

Accept: */*
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9,ko;q=0.8,ja;q=0.7,la;q=0.6
Access-Control-Request-Headers: content-type
Access-Control-Request-Method: GET
Connection: keep-alive
Host: www.jobkorea.com
Origin: https://www.yebalja.com/
Referer: https://www.yebalja.com/jobs/1
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: cross-site
```

1. jobkorea 서버는 Option, 예비 요청에 응답해줌 200ok

```
OPTIONS https://www.yebalja.com/jobs/ 200 OK

Access-Control-Allow-Origin:  https://www.jobkorea.com/
Content-Encoding: gzip
Content-Length: 699
Content-Type: text/xml; charset=utf-8
Date: Sun, 24 May 2020 11:52:33 GMT
P3P: CP='ALL DSP COR MON LAW OUR LEG DEL'
Server: Apache
Vary: Accept-Encoding
X-UA-Compatible: IE=Edge
```

이때 웹 서버의 요청 응답의
Access-Control-Allow-Origin: https://www.jobkorea.com/
부분이 Option 요청메세지의 orgin과 달라서 클라이언트(브라우저)가 CORS 정책을 위반했다고 판단하고 에러를 뱉어냄

------

참고
https://www.codecademy.com/articles/what-is-cors
https://evan-moon.github.io/2020/05/21/about-cors/
https://www.youtube.com/watch?v=yTzAjidyyqs

---

###### 7. 학습 내용에 대한 개인적인 총평

- CORS와 정책위반시 해결방법에 대해 학습

###### 8. 다음 학습 계획

- OS, 인터뷰