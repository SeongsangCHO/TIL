---
###### 1. 학습 날짜

- 2020 - 07 - 06(월)
 

---

###### 2. 학습시간

- 10:00 ~ 17:00
- 19:00 ~ 22:00

---

###### 3. 학습 범위 및 주제

- ft_printf 구현

---

###### 4. 동료 학습 방법 

- taelee, daelee, mihykim, jehong

---

###### 5. 학습 목표 

- ft_printf를 구현합니다.

---

###### 6. 상세 학습 내용

- 코드작성시간 :  5시간

## ft_printf 정리

<br>

### 1. ft_print.c

#### 1.1 ft_print(const char * format, ...)

- printf에서 " "으로 감싸진 `const char *format` 문자열을 매개변수로 갖는 함수
- 반환 값은 출력되는 문자열의 길이.

기능

- 입력된 format에서 flag, width, precision, type의 데이터를 추출하기 위한 문자열을 `strdup`를 이용해 복사한다.
- 가변인수 함수를 사용하기 위해 `va_list, va_start`를 사용하고 이 후 함수에서 ap번지에 접근하여 인수들을 출력하기 위해 ap를 매개변수로 넘겨준다.
- ap, str을 매개변수로 갖는 함수  `ft_handle_args`를 호출한다.

<br>

#### 1.2 ft_handle_args (const char *str, va_list ap)

- str에서 추출한 데이터를 저장하기 위한 구조체를 선언하고 초기화한다.
- `%`로 구분하여 그 이전까지의 문자들을 출력한다.
- `%`를 만나면, 데이터를 추출하기 위한 `ft_parse`를 호출한다.
- 추출한 데이터를 기반으로 type에 맞추어 문자열을 출력하는 `ft_handle`을 호출한다.

기능

- `ft_bzero`로 구조체의 메모리로 접근해 구조체 멤버변수들의 값을 초기화한다.
- `ft_parse`를 호출한다.

<br>

#### 1.3 ft_parse(const char *str, int i, va_list ap, t_list *lst)

- format을 복사한 문자열인 str을 한 글자씩 쪼개어 유효성검사를 진행한다.
- 제시된 type, flag, 숫자인지 확인하고 조건에 맞지 않으면 구조체에 저장하지 않고 그대로 출력한다.
- 저장한 글자만큼 인덱스를 추가하고, 유효하지 않는 데이터는 그대로 출력하며 건너뛴다.
- 오는 글자가 0이고 width == 0, precison이 없을 때 zero를 set한다
  - %50d의 0은 zero로 set되면 안되므로, width가 0인 조건을 추가한다.
  - %50.0d는 precision이 0이므로 zero가 set되면 안된다. 따라서 precision이 없을 때의 조건을 추가한다.

<br>

#### 1.4 ft_handle(int c, t_list lst, va_list ap)

- type에 맞게 handle하는 함수를 호출한다.
- x, X, p는 16진수로 변환하여 출력하기에 base를 16으로 SET한다.

<br>

### 2. %d , %i출력

#### 2.1 ft_handle_nbr(unsigned long long nbr, t_list lst)

- 부호있는 10진법 정수

- 들어온 값이 음수이고, type이 i 또는 d인 부호있는 10진수일 때 nbr을 양수로, nbr_minus의 값을 1로 SET한다.
- 출력할 str을 만들기 위해 str_len을 계산한다.
- 계산된 str_len에 맞추어 str의 메모리를 동적할당한다.
- 출력될 str이 구성되면 putstr을 통해 출력한다.

<br>

#### 2.1 ft_prec_len(unsigned long long nbr, t_list lst, char **content)

- nbr의 길이를 재어 precision과 비교해 min_len으로 할당한다.

  - `ft_nbrlen(nbr, t_list lst)` - nbr이 0이고 precision이 0이 아닐 때 1을 반환한다.
  - ("%d.3" , 0) => |000|

- min_len은 precision , str_len 길이 비교를 하여 출력될 길이를 구한다.

  - %d.10, 1 => |0000000001|
  - min_len으로 content의 사이즈를 할당한다.
  - 할당된 content배열에 null, 0값으로 초기화한다.

  nbr이 0이고 precision이 0이 아닐때, 즉 set, unset일 때 content의 값은 '0'을 갖는다.

  - %d.3, 0 => content = "0" => 00은 이후 처리

  nbr을 base에 맞춰 진법변환을 진행한 값을 content에 채운다.

  nbr의 길이를 반환한다(str_len).

  <br>

#### 2.2 ft_put_minus(char **content, t_list lst, int str_len)

- nbr_minus가 set, zero가 unset이면, 맨 왼쪽 값은 무조건 '-'이다.
- 조건과 str_join을 이용해 content에 '-' 캐릭터를 할당한다.
- '-' 캐릭터 글자 1의 길이를 반환한다.

<br>

#### 2.3 ft_width_str(char **content, t_list lst)

- content의 길이가 width보다 크거나 같을 때, content의 길이를 반환한다.
- ret배열은 width와 content의 길이를 뺀만큼의 사이즈를 갖는 배열이다.
- **그 만큼, zero가 set인지 unset인지에 따라 0을 넣거나 공백을 넣는다.**
- 생성된 ret배열을 minus가 set인지 unset인지에 따라 content의 앞, 뒤쪽으로 join한다.
- 첫번째 조건문이 아닐시 반환값은 width가 된다.

<br>

#### 2.4 ft_put_minus2(char **content, t_list lst, int str_len)

nbr가 음수이고 **zero가 set**일 때

str_len이 width보다 크거나 같을 때

- %05d, -12345 => 위의 조건을 만족, put_minus1의 조건에는 만족하지 않음.
- content에 -를 추가함.
- ret를 추가할 필요가 없음.

strlen이 width보다 작을 때.

- %07d, 12345
- content의 첫번째 원소에 -를 할당한다.
- 0또는 공백으로 차지하고 있는 맨 앞자리[0]에 '-'를 할당한다.

#### 2.5 ft_putstr

모든 str를 출력한다.

<br>

### 3. %c, %% 출력

minus가 set되어 있을 때 입력받은 문자를 출력한다.

%타입일 때 zero, minus set에 따라 0또는 공백 출력하도록 한다.

c타입일 때 zero에 따라 0또는 공백을 출력한다.

minus타입이 unset일 때 위의 과정을 진행하고 글자를 출력한다.

<br>

### 4. %s 출력



#### ft_handle_stringIchar *str, t_list lst)

- str이 null일 때 "(null)"으로 할당한다.
- precision에 맞추어 출력될 문자열이 잘리기 때문에 조건에 맞추어 precision값을 조정한다.
- 조정된 precision값으로 출력될 문자열의 메모리를 할당하는 `ft_slice_string`함수를 호출한다.

#### 4.1 ft_slice_string(char *str, int end)

- 입력된 precision값과 현재 str값의 길이를 비교하여 출력될 문자열의 메모리사이즈를 계산하고 할당한다.

- 출력될 사이즈만큼 content에 문자열값을 할당하고 이를 반환한다.

<br>

[2.3의 width_str](#2.3 ft_width_str)사용

#### 4.2 ft_putstr

content 출력

<br>

#### x, X, u, p는 [2. %d, %i](# 2. %d, %i출력)함수로 처리



---

###### 7. 학습 내용에 대한 개인적인 총평

- 조건이 너무 다양해 머리속에 한번에 들어오지 않았습니다.

- 조건에 따라 각 모듈을 구현하려 했지만 비효율적이라고 생각해 동료의 도움을 받았습니다.

- 각 printf의 플래그와 옵션을 고려하여 배열을 할당해 출력해주는 방식으로 구현했습니다.

- 지난 1주일간 이사오고 printf구현만 진행해서 따로 작성할 사안이 없었습니다. 그러다보니 언제 무엇을 알았는지 파악이 어려웠습니다. 양에 구애받지 않고 조금이나마 작성해야합니다.

  

###### 8. 다음 학습 계획

- 알고리즘 문제 학습
- 웹서비스구현을 위한 학습

